@inject CommentClient CommentClient
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime

<div class="collapse" id="commentCollapseToJoke_@Comment.JokeId">
  <div class="card card-body rounded-4 mb-4 p-3 position-relative" style="max-width: 22rem;">
    
    <!-- Action buttons in top-right corner -->
    <div class="position-absolute top-0 end-0 p-2">
      <a class="btn btn-outline-secondary btn-sm me-1" href="@CommentUrl(Comment.CommentId)" title="Edit">
        <i class="bi bi-pencil"></i>
      </a>
      <button class="btn btn-outline-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteCommentModal_@Comment.CommentId" title="Delete">
        <i class="bi bi-trash"></i>
      </button>
    </div>

    <!-- Content -->
    <p class="card-text text-secondary">@Comment.CommentText</p>
  </div>

  <!-- Optional: delete modal -->
  <div class="modal fade" id="deleteCommentModal_@Comment.CommentId" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Delete comment?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete <strong>comment</strong>?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" @onclick="() => OnDeleteCommentAsync(Comment.CommentId)">Delete</button>
        </div>
      </div>
    </div>
  </div>
</div>

@code {
    [Parameter]
    public Comment Comment { get; set; } = default!;

    private static string CommentUrl(int id) => $"/editComment/{id}";

    private async Task OnDeleteCommentAsync(int id)
    {
        await CommentClient.DeleteCommentAsync(id);
        NavigationManager.Refresh();
    }
}
